#include <iostream>
#include <algorithm>
#include <cmath>
using namespace std;

int absDiff(int a, int b) {
    return abs(a - b);
}

// ------------------ SSTF ------------------
void sstf(int req[], int n, int head) {
    int visited[100] = {0};
    int total = 0, pos = head;

    cout << "\nSSTF Order: " << pos;

    for(int count = 0; count < n; count++) {
        int idx = -1, minDist = 999999;

        for(int i = 0; i < n; i++) {
            if(!visited[i]) {
                int dist = absDiff(pos, req[i]);
                if(dist < minDist) {
                    minDist = dist;
                    idx = i;
                }
            }
        }

        visited[idx] = 1;
        total += minDist;
        pos = req[idx];

        cout << " -> " << pos;
    }

    cout << "\nTotal Head Movement (SSTF) = " << total << "\n";
}

// ------------------ SCAN ------------------
void scan(int req[], int n, int head, int maxCyl) {
    int left[100], right[100];
    int l = 0, r = 0;

    // moving away from spindle means moving upward (towards max)
    right[r++] = maxCyl;

    for(int i = 0; i < n; i++) {
        if(req[i] >= head)
            right[r++] = req[i];
        else
            left[l++] = req[i];
    }

    sort(right, right + r);
    sort(left, left + l);

    int total = 0, pos = head;

    cout << "\nSCAN Order: " << pos;

    // Move upward first
    for(int i = 0; i < r; i++) {
        total += absDiff(pos, right[i]);
        pos = right[i];
        cout << " -> " << pos;
    }

    // Then go downward
    for(int i = l - 1; i >= 0; i--) {
        total += absDiff(pos, left[i]);
        pos = left[i];
        cout << " -> " << pos;
    }

    cout << "\nTotal Head Movement (SCAN) = " << total << "\n";
}

// ------------------ C-LOOK ------------------
void clook(int req[], int n, int head) {
    int left[100], right[100];
    int l = 0, r = 0;

    for(int i = 0; i < n; i++) {
        if(req[i] >= head)
            right[r++] = req[i];
        else
            left[l++] = req[i];
    }

    sort(right, right + r);
    sort(left, left + l);

    int total = 0, pos = head;

    cout << "\nC-LOOK Order: " << pos;

    // Move upward first
    for(int i = 0; i < r; i++) {
        total += absDiff(pos, right[i]);
        pos = right[i];
        cout << " -> " << pos;
    }

    // Jump to smallest request (circular)
    if(l > 0) {
        total += absDiff(pos, left[0]);
        pos = left[0];
        cout << " -> " << pos;

        for(int i = 1; i < l; i++) {
            total += absDiff(pos, left[i]);
            pos = left[i];
            cout << " -> " << pos;
        }
    }

    cout << "\nTotal Head Movement (C-LOOK) = " << total << "\n";
}

int main() {

    int n, head, maxCyl;

    cout << "Enter total number of cylinders: ";
    cin >> maxCyl;

    cout << "Enter number of disk requests: ";
    cin >> n;

    int req[100];

    cout << "Enter " << n << " disk requests:\n";
    for(int i = 0; i < n; i++)
        cin >> req[i];

    cout << "Enter initial head position: ";
    cin >> head;

    sstf(req, n, head);
    scan(req, n, head, maxCyl - 1);   // cylinders range from 0 to maxCyl-1
    clook(req, n, head);

    return 0;
}
